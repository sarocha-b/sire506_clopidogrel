# SIRE506 Problem Set

------
## About the data
The dataset “platelet.csv” contains data from 211 individuals tested for platelet aggregation, and genotyped three genetic markers. 
Work on the data in the enclosed folder PlateletHW.csv

The variables contained in this dataset are:
-	IID: Unique individual identification number
-	rs4244285: CYP2C19*2 genotype coded as 0, 1, and 2 based on the number of mutation
-	rs4244285: CYP2C19*3 genotype coded as 0 and 1 based on the number of mutation (there was no one with homozygous CYP2C19*3 mutation).
-	rs662: PON1 genotype at the position 192Q>R, coded as 0, 1, and 2 based on the number of mutation (0 means QQ, 1 means QR, and 2 means RR genotype).
-	ADP: the level of ADP induced platelet aggregation. The more platelet aggregation that can occur means that the patients did not response to the precribed anti-platelet drugs i.e. Clopidogrel in this study.
-	Resistance: a binary variable, 1 representing the clopidogrel non-responders, and 0 representing clopidogrel responders.

## Questions
### 1. Import the data

From plateletHW.csv, use e.g. readr::read_table() to import the data into a data frame called “clopidogrel”

```{r}
library(readr)
clopidogrel <- readr::read_delim("PlateletHW.tsv", 
    delim = "\t", escape_double = FALSE, 
    trim_ws = TRUE)
View(clopidogrel)
```
- Notice that I use `readr::read_delim` to clearly explain what library `read_delim` is loaded from. This makes the code easier to read and review in the future. 

 
### 2.	Check for outliers and distribution.
- How can you visualize the distribution of `ADP`?

- Try histogram
```{r}
hist(clopidogrel$ADP,
     main = "Histogram of ADP-induced Platelet Aggregation",
     xlab = "ADP",
     col = "lightblue")
```

- Try ploting as box-plot 
```{r}
boxplot(clopidogrel$ADP,
        main = "Boxplot of ADP",
        ylab = "ADP",
        col = "lightblue")
```

- What type of variable is `ADP`? Is it a continuous variable or a categorical variable?
continuous variable

- Try `summary`
```{r}
summary(clopidogrel)
# can you specifically summarize "ADP" alone?
summary(clopidogrel$ADP)
```

- Are there any outliers or impossible values? What does a negative value of `ADP` mean?
there is a impossible value: the minimum value of −8.72. 
negative value of `ADP` mean deaggregation after stimulation.

- What does the mean of a binary variable `Resistance` tell us? 
The proportion of individuals in the sample who are Clopidogrel Non-responders.

- How would you describe the central tendency of this variable? i.e. will you use the mean and standard deviation or proportion of ADP induced platelet aggregation as a summary statistics to represent platelet aggregation level of these patients? 
Because ADP is a continuous variable and Right-Skewed (Mean>Median). Median and Interquartile Range (IQR) are the most appropriate statistics for summarizing central tendency and dispersion.

Write a sentence or two to describe the distribution of platelet aggregation in this dataset. 
The ADP induced platelet aggregation levels in this dataset range widely from a minimum of −8.721 to a maximum of 103.053, with a median value of 27.200. The distribution is Right-Skewed as the mean is 40.853 that higher than the median, suggesting a some of patients with very high levels of platelet aggregation.



### 3.	Comparison
- What is the differences between mean platelet aggregation level between the two groups of individuals with CYPC19*3 mutation? Do individuals with CYP2C19*3 mutation (CYP3 coded as 1) have higher level of platelet aggregation than individuals without CYP2C19*3 mutation (CYP3 coded as 0)? Is the difference statistically significant (what is the p-value for association)?

```{r}
mean(clopidogrel$ADP[clopidogrel$rs4986893 == 0])
mean(clopidogrel$ADP[clopidogrel$rs4986893 == 1])
```

```{r}
gtsummary::tbl_regression(glm(ADP ~ rs4986893 , data = clopidogrel))
glm(ADP ~ rs4986893, data = clopidogrel)
```
#### Age and Sex adjusted?
- Is age or sex a confounding factor?
Age and Sex are not confounder.
- How can we control the effect of age and sex in the model?
We can control for the effect of age and sex by including them as covariates in the linear regression model.
```{r}
glm(ADP ~ rs4986893 + AGE + SEX, data = clopidogrel) 
gtsummary::tbl_regression(glm(ADP ~ rs4986893 + AGE + SEX, data = clopidogrel) )
```

```{r}
cor(clopidogrel$ADP, clopidogrel$AGE )
cor(clopidogrel$ADP, clopidogrel$AGE, method = "pearson", use = "complete.obs")  
glm(ADP ~ AGE, data = clopidogrel)
gtsummary::tbl_regression(glm(ADP ~ AGE, data = clopidogrel)) 


cor(clopidogrel$ADP, clopidogrel$SEX )
cor(clopidogrel$ADP, clopidogrel$SEX, method = "pearson", use = "complete.obs") 
glm(ADP ~ SEX, data = clopidogrel)
gtsummary::tbl_regression(glm(ADP ~ SEX, data = clopidogrel))
```


The mean platelet aggregation in individuals with CYP2C19*3 mutation was 65.22, compared to 39.12 in individuals without CYP2C19*3 mutation.  The group with CYP2C19*3 mutation on average had 26.10 unit higher platelet aggregation level that the individuals without CYP2C19*3 mutation (95% CI from 9.5 to 43). The difference in platelet aggregation between genotype groups was statistically different (p = 0.002).

 
